<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CSV Column Display with Count and Percentage (Average)</title>
    <link rel="stylesheet" href="style/weeklygoals.css">
    <link rel="icon" type="image/x-icon" href="/favicon.ico">
</head>
<body>
    <nav style="text-align: center; margin: 20px 0;">
        <ul style="list-style-type: none; padding: 0; display: inline-flex; gap: 40px;">
            <li>
                <a href="index.html"  style="text-decoration: none; color: #0056b3; font-weight: bold; font-size: 18px; padding: 10px 20px; border: 2px solid #0056b3; border-radius: 5px; transition: all 0.3s;">
                    Dashboard
                </a>
            </li>
            <li>
                <a href="/Po.html"  style="text-decoration: none; color: #0056b3; font-weight: bold; font-size: 18px; padding: 10px 20px; border: 2px solid #0056b3; border-radius: 5px; transition: all 0.3s;">
                    PO Percentage by Counter Person
                </a>
            </li>
             <li>
                <a href="/So.html"  style="text-decoration: none; color: #0056b3; font-weight: bold; font-size: 18px; padding: 10px 20px; border: 2px solid #0056b3; border-radius: 5px; transition: all 0.3s;">
                  SO Percentage by Counter Person
                </a>
            </li>
        </ul>
    </nav>

    <!-- --- Google Sheets Sign In --- -->
    <button id="signout_button" style="display:none;margin-left:12px;font-size:1.1em;">Sign out</button>

    <h1>Weekly Goals</h1>
    <div class="download-info" id="csvDate"></div>
      <button id="authorize_button" style="margin: 18px 0 8px 0; font-size: 1.1em;">Sign in to View Google Sheet</button>

   <div style="display:none;">
  <div id="dropZone">
    <p>Drag and drop your CSV file here or</p>
    <label for="csvFileInput" style="color: #0044cc; cursor: pointer; text-decoration: underline;">click</label>
    to upload.
    <input type="file" id="csvFileInput" style="display: none;" accept=".csv" />
  </div>
</div>

    <div id="table-container"></div>

    <div class="loading-bar-overlay" id="loadingBarOverlay" style="display: none;">
      <div class="loading-bar-container" id="loadingBarContainer">
        <div class="loading-bar" id="loadingBar"></div>
      </div>
    </div>

    <button id="copy-today-column-btn" style="display:none;position:fixed;bottom:32px;right:32px;z-index:9999;">Copy 7/21 Column Values</button>

    <!-- Luxon must come first for date handling -->
<!-- 1. Load Luxon first -->
<script src="https://cdn.jsdelivr.net/npm/luxon@3/build/global/luxon.min.js"></script>
<!-- 2. Load your functions (where gapiLoaded/gisLoaded are defined) -->
<script src="js/weeklygoals2.js"></script>
<!-- 3. THEN load the APIs that will call those functions -->
<script src="https://apis.google.com/js/api.js" onload="gapiLoaded()"></script>
<script src="https://accounts.google.com/gsi/client" onload="gisLoaded()" async defer></script>



</body>